<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CrediFit-Konto erstellen</title>
    <link rel="stylesheet" href="styles/styles.css">
    <link rel="stylesheet" href="styles/style2.css">
</head>

<body>
    <div class="container">
        <!-- Logo Container in anderen Container einbinden -->
        <div class="logo-container">
            <img class="logo" src="Bilder/CrediFit Logo.png" alt="Credifit Logo">
        </div>
        <h2>CrediFit-Konto erstellen</h2>
        <form id="signupForm">
            <input type="text" id="name" placeholder="Name" required><br>
            <select id="studiengang" required>
                <option value="" disabled selected>Wähle deinen Studiengang</option>
            </select>
            <input type="email" id="email" placeholder="E-Mail" required><br>
            <input type="password" id="password" placeholder="Passwort" required><br>
            <button type="submit">Für CrediFit registrieren</button>
        </form>
        <body>
            <p>Du hast schon ein CrediFit-Konto? <a href="screen1.html">Jetzt einloggen</a></p>
        </div>

    <script>
        // Funktion, um Studiengänge aus Supabase abzurufen und im Dropdown anzuzeigen
        async function loadStudiengänge() {
            const { data, error } = await supabase
                .from('Studiengänge') // Ersetze 'deine_tabelle' durch den Namen deiner Supabase-Tabelle
                .select('studiengang');

            if (error) {
                alert('Es ist ein Fehler beim Laden der Studiengänge aufgetreten: ' + error.message);
            } else {
                const studiengangDropdown = document.getElementById('studiengang');

                data.forEach((row) => {
                    const option = document.createElement('option');
                    option.value = row.studiengang;
                    option.textContent = row.studiengang;
                    studiengangDropdown.appendChild(option);
                });
            }
        }

        // Event-Listener für das Formular
        document.getElementById('signupForm').addEventListener('submit', async function (event) {
            event.preventDefault();

            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;
            const selectedStudiengang = document.getElementById('studiengang').value;
            const password = document.getElementById('password').value;

            // Daten an Supabase senden
            const { data, error } = await supabase
                .from('deine_tabelle') // Ersetze 'deine_tabelle' durch den Namen deiner Supabase-Tabelle
                .upsert([
                    {
                        name: name,
                        email: email,
                        studiengang: selectedStudiengang,
                        password: password
                    }
                ]);

            if (error) {
                alert('Es ist ein Fehler aufgetreten: ' + error.message);
            } else {
                alert(`Glückwunsch, ${name}! Du hast dich erfolgreich angemeldet.`);
                // Hier kannst du die Weiterleitung zur nächsten Seite oder andere Aktionen einfügen.
            }
        });

        // Lade Studiengänge, wenn die Seite geladen wird
        loadStudiengänge();
    </script>
</body>
</html>